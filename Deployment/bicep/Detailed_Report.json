{
    "version": "Notebook/1.0",
    "items": [
      {
        "type": 1,
        "content": {
          "json": "# Guardrail Controls"
        },
        "name": "text - 0"
      },
      {
        "type": 1,
        "content": {
          "json": "## Guardrails - Control 8 - Segmentation/Separation"
        },
        "name": "text - 1"
      },
      {
        "type": 11,
        "content": {
          "version": "LinkItem/1.0",
          "style": "tabs",
          "links": [
            {
              "id": "97995b23-318a-4818-a7b3-83c2e387c9c0",
              "cellValue": "gr8TabSelection",
              "linkTarget": "parameter",
              "linkLabel": "Summary",
              "subTarget": "summary",
              "style": "link"
            },
            {
              "id": "2a190f6d-38e6-41df-9948-e584d51277c8",
              "cellValue": "gr8TabSelection",
              "linkTarget": "parameter",
              "linkLabel": "Details",
              "subTarget": "details",
              "style": "link"
            }
          ]
        },
        "name": "links - 5"
      },
      {
        "type": 3,
        "content": {
          "version": "KqlItem/1.0",
          "query": "GuardrailsCompliance_CL\r\n| where ControlName_s has \"GUARDRAIL 8:\" \r\n| summarize SubnetCount=count() by Compliant=ComplianceStatus_b",
          "size": 1,
          "timeContext": {
            "durationMs": 3600000
          },
          "queryType": 0,
          "resourceType": "microsoft.operationalinsights/workspaces",
          "visualization": "table",
          "tileSettings": {
            "titleContent": {
              "columnMatch": "Is_Compliant"
            },
            "showBorder": false
          }
        },
        "conditionalVisibility": {
          "parameterName": "gr8TabSelection",
          "comparison": "isEqualTo",
          "value": "summary"
        },
        "name": "query - 2"
      },
      {
        "type": 3,
        "content": {
          "version": "KqlItem/1.0",
          "query": "GuardrailsCompliance_CL\r\n| where ControlName_s has \"GUARDRAIL 8:\" \r\n| project SubnetName_s, ComplianceStatus_b, Comments_s\r\n| sort by ComplianceStatus_b asc",
          "size": 0,
          "timeContext": {
            "durationMs": 1800000
          },
          "queryType": 0,
          "resourceType": "microsoft.operationalinsights/workspaces"
        },
        "conditionalVisibility": {
          "parameterName": "gr8TabSelection",
          "comparison": "isEqualTo",
          "value": "details"
        },
        "name": "query - 3"
      },
      {
        "type": 1,
        "content": {
          "json": "## Guardrails - Control 9 - Security"
        },
        "name": "text - 1 - Copy"
      },
      {
        "type": 11,
        "content": {
          "version": "LinkItem/1.0",
          "style": "tabs",
          "links": [
            {
              "id": "66d69674-d06a-4d6d-b88c-6b7d788386bc",
              "cellValue": "gr9TabSelection",
              "linkTarget": "parameter",
              "linkLabel": "Summary",
              "subTarget": "summary",
              "style": "link"
            },
            {
              "id": "20c66db7-5c36-4e8d-b759-fcfbb9048b49",
              "cellValue": "gr9TabSelection",
              "linkTarget": "parameter",
              "linkLabel": "Details",
              "subTarget": "details",
              "style": "link"
            }
          ]
        },
        "name": "links - 5 - Copy"
      },
      {
        "type": 3,
        "content": {
          "version": "KqlItem/1.0",
          "query": "GuardrailsCompliance_CL\r\n| where ControlName_s has \"GUARDRAIL 9:\" \r\n| summarize count() by ComplianceStatus_b",
          "size": 0,
          "timeContext": {
            "durationMs": 86400000
          },
          "queryType": 0,
          "resourceType": "microsoft.operationalinsights/workspaces"
        },
        "conditionalVisibility": {
          "parameterName": "gr9TabSelection",
          "comparison": "isEqualTo",
          "value": "summary"
        },
        "name": "query - 7"
      },
      {
        "type": 3,
        "content": {
          "version": "KqlItem/1.0",
          "query": "GuardrailsCompliance_CL\r\n| where ControlName_s has \"GUARDRAIL 9:\" \r\n| project VNETName_s, ComplianceStatus_b, Comments_s\r\n",
          "size": 0,
          "timeContext": {
            "durationMs": 1800000
          },
          "queryType": 0,
          "resourceType": "microsoft.operationalinsights/workspaces"
        },
        "conditionalVisibility": {
          "parameterName": "gr9TabSelection",
          "comparison": "isEqualTo",
          "value": "details"
        },
        "name": "query - 8"
      }
    ],
    "fallbackResourceIds": [
      "/subscriptions/b1e924f9-d16f-4260-a3c8-ff1ee462956b/resourceGroups/Guardrailtest3/providers/Microsoft.OperationalInsights/workspaces/guardrailstest3-LAW"
    ],
    "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
  }